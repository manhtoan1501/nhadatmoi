{"ast":null,"code":"import _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _Array$isArray from \"@babel/runtime-corejs2/core-js/array/is-array\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\manh nhan\\\\Desktop\\\\new_ndm\\\\components\\\\Channel\\\\Tabs\\\\Rating.tsx\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { Typography, CardHeader, Avatar, Grid } from '@material-ui/core';\nimport Rating from '@material-ui/lab/Rating';\nimport { ratings, ratingStyles } from \"../Constant\";\nimport { apolloClient } from \"../../../utils\";\nimport { GET_RATINGS_CHANNEL_BY_ID, GET_AVERAGE_RATING } from \"../../../graphql/channel/queries\";\nimport GradeIcon from '@material-ui/icons/Grade';\nimport _ from \"lodash\";\nimport moment from \"moment\";\nimport 'moment/locale/es'; // without this line it didn't work\n\nmoment.locale('vi');\n;\n;\n;\nvar avatar = \"https://1.bp.blogspot.com/-gx54Ig64I_k/WnktM_nzPXI/AAAAAAAAHgw/E7pSRwrXu_c3tSSg-vbO2iQgg4GbVxGKwCLcBGAs/s1600/anh-girl-xinh-9x-kute%2B%252811%2529.jpg\";\n\nvar Ratings = function Ratings(props) {\n  var classes = ratingStyles();\n\n  var _React$useState = React.useState(),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      averageRating = _React$useState2[0],\n      setAverageRating = _React$useState2[1];\n\n  var _React$useState3 = React.useState([]),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      ratingsChannel = _React$useState4[0],\n      setRatingsChannel = _React$useState4[1];\n\n  React.useEffect(function () {\n    getAdChannel();\n    getAverageRating();\n  });\n\n  var getAdChannel = function getAdChannel() {\n    var id, ratingsChannel;\n    return _regeneratorRuntime.async(function getAdChannel$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            id = props.channelId;\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(apolloClient.query({\n              query: GET_RATINGS_CHANNEL_BY_ID,\n              variables: {\n                \"id\": id,\n                \"limit\": 18,\n                \"page\": 1\n              }\n            }).then(function (response) {\n              return response.data.channelAdSellLeaseRatings.edges;\n            }));\n\n          case 3:\n            ratingsChannel = _context.sent;\n\n            if (_Array$isArray(ratingsChannel)) {\n              setRatingsChannel(ratingsChannel);\n            }\n\n            ;\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, _Promise);\n  };\n\n  var getAverageRating = function getAverageRating() {\n    var res;\n    return _regeneratorRuntime.async(function getAverageRating$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(apolloClient.query({\n              query: GET_AVERAGE_RATING,\n              variables: {\n                \"id\": props.channelId\n              }\n            }).then(function (response) {\n              var averageRating = _.get(response, \"data.channelAverageRatings\", {});\n\n              setAverageRating(averageRating);\n            }));\n\n          case 2:\n            res = _context2.sent;\n\n          case 3:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, _Promise);\n  };\n\n  var renderRating = function renderRating() {\n    return ratings.map(function (item, index) {\n      return __jsx(\"div\", {\n        key: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }, __jsx(CardHeader, {\n        avatar: __jsx(Avatar, {\n          alt: \"Reviewer\",\n          src: avatar,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 86\n          },\n          __self: this\n        }, item.name),\n        disableTypography: true,\n        subheader: __jsx(\"div\", {\n          className: classes.subheader,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 89\n          },\n          __self: this\n        }, __jsx(Typography, {\n          variant: \"body2\",\n          className: classes.rating,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90\n          },\n          __self: this\n        }, \"\\u0110\\xE1nh gi\\xE1 b\\u1EDFi:\"), __jsx(Typography, {\n          className: classes.userRating,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91\n          },\n          __self: this\n        }, item.name), __jsx(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91\n          },\n          __self: this\n        }), __jsx(Rating, {\n          disabled: true,\n          name: \"simple-controlled\",\n          value: item.rating,\n          style: {\n            color: \"#045EA8\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 92\n          },\n          __self: this\n        }), __jsx(Typography, {\n          variant: \"body2\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98\n          },\n          __self: this\n        }, moment(item.time).fromNow())),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }));\n    });\n  };\n\n  var renderRatingChanel = function renderRatingChanel() {\n    return ratingsChannel.map(function (item, index) {\n      return __jsx(\"div\", {\n        key: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, __jsx(CardHeader, {\n        avatar: __jsx(Avatar, {\n          alt: \"Reviewer\",\n          src: item.node.user_id.avatar || avatar,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          },\n          __self: this\n        }, item.node.user_id.avatar),\n        disableTypography: true,\n        subheader: __jsx(\"div\", {\n          className: classes.subheader,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 115\n          },\n          __self: this\n        }, __jsx(Typography, {\n          variant: \"body2\",\n          className: classes.rating,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 116\n          },\n          __self: this\n        }, \"\\u0110\\xE1nh gi\\xE1 b\\u1EDFi:\"), __jsx(Typography, {\n          className: classes.userRating,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 117\n          },\n          __self: this\n        }, item.node.user_id.first_name, \" \", item.node.user_id.last_name), __jsx(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 117\n          },\n          __self: this\n        }), __jsx(Rating, {\n          disabled: true,\n          name: \"simple-controlled\",\n          value: item.node.rate,\n          style: {\n            color: \"#045EA8\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118\n          },\n          __self: this\n        }), __jsx(Typography, {\n          variant: \"body2\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124\n          },\n          __self: this\n        }, moment(Number(item.node.created_at)).fromNow())),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }));\n    });\n  };\n\n  var count_rating = _.get(averageRating, \"count_rating\", 1);\n\n  var fiveRating = _parseInt(\"\".concat(_.get(averageRating, \"five_star\", 0) / count_rating * 100));\n\n  var fourRating = _parseInt(\"\".concat(_.get(averageRating, \"four_star\", 0) / count_rating * 100));\n\n  var threeRating = _parseInt(\"\".concat(_.get(averageRating, \"three_star\", 0) / count_rating * 100));\n\n  var twoRating = _parseInt(\"\".concat(_.get(averageRating, \"two_star\", 0) / count_rating * 100));\n\n  var oneRating = _parseInt(\"\".concat(_.get(averageRating, \"one_star\", 0) / count_rating * 100));\n\n  var renderAverageRating = function renderAverageRating() {\n    var total = ratingsChannel.length;\n    var arrTotalRating = [{\n      width: \"\".concat(fiveRating, \"%\")\n    }, {\n      width: \"\".concat(fourRating, \"%\")\n    }, {\n      width: \"\".concat(threeRating, \"%\")\n    }, {\n      width: \"\".concat(twoRating, \"%\")\n    }, {\n      width: \"\".concat(oneRating, \"%\")\n    }];\n    return __jsx(\"div\", {\n      className: classes.averageRating,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: classes.averageRatingTotal,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, __jsx(\"p\", {\n      className: classes.averageRatingLevel,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, \"3.0\"), __jsx(Grid, {\n      container: true,\n      alignItems: \"center\",\n      justify: \"center\",\n      spacing: 0,\n      className: classes.averageViewRating,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, __jsx(Grid, {\n      item: true,\n      xs: 8,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, __jsx(Rating, {\n      disabled: true,\n      name: \"simple-controlled\",\n      value: 3,\n      style: {\n        color: \"#045EA8\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    })), __jsx(Grid, {\n      item: true,\n      xs: 4,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, __jsx(Typography, {\n      variant: \"h5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, total)))), __jsx(\"div\", {\n      className: classes.averageRatingDescribe,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, arrTotalRating.map(function (item, index) {\n      return __jsx(\"div\", {\n        style: {\n          marginLeft: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: classes.levelRating,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, 5 - index, __jsx(GradeIcon, {\n        className: classes.levelRatingIcon,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      })), __jsx(\"div\", {\n        className: classes.averageRatingDescribeFive,\n        key: index,\n        style: {\n          marginLeft: 40\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: classes.averageRatingDescribeFiveLevel,\n        style: {\n          width: item.width\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      })));\n    })), __jsx(\"div\", {\n      style: {\n        clear: \"both\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }));\n  };\n\n  return __jsx(\"div\", {\n    className: classes.rootRating,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }, __jsx(Typography, {\n    variant: \"h5\",\n    className: classes.titleRating,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }, \"\\u0110\\xE1nh gi\\xE1 ch\\u1EA5t l\\u01B0\\u1EE3ng\"), renderAverageRating(), __jsx(\"div\", {\n    className: classes.ratingList,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  }, __jsx(Typography, {\n    variant: \"h5\",\n    className: classes.titleRating,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }, \"\\u0110\\xE1nh gi\\xE1 g\\u1EA7n nh\\u1EA5t\"), _Array$isArray(ratings) ? renderRatingChanel() : __jsx(Typography, {\n    align: \"center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188\n    },\n    __self: this\n  }, \"Kh\\xF4ng c\\xF3 \\u0111\\xE1nh gi\\xE1 n\\xE0o\")));\n};\n\nexport default Ratings;","map":{"version":3,"sources":["C:/Users/manh nhan/Desktop/new_ndm/components/Channel/Tabs/Rating.tsx"],"names":["React","Typography","CardHeader","Avatar","Grid","Rating","ratings","ratingStyles","apolloClient","GET_RATINGS_CHANNEL_BY_ID","GET_AVERAGE_RATING","GradeIcon","_","moment","locale","avatar","Ratings","props","classes","useState","averageRating","setAverageRating","ratingsChannel","setRatingsChannel","useEffect","getAdChannel","getAverageRating","id","channelId","query","variables","then","response","data","channelAdSellLeaseRatings","edges","get","res","renderRating","map","item","index","name","subheader","rating","userRating","color","time","fromNow","renderRatingChanel","node","user_id","first_name","last_name","rate","Number","created_at","count_rating","fiveRating","fourRating","threeRating","twoRating","oneRating","renderAverageRating","total","length","arrTotalRating","width","averageRatingTotal","averageRatingLevel","averageViewRating","averageRatingDescribe","marginLeft","levelRating","levelRatingIcon","averageRatingDescribeFive","averageRatingDescribeFiveLevel","clear","rootRating","titleRating","ratingList"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { Typography, CardHeader, Avatar, Grid } from '@material-ui/core';\r\nimport Rating from '@material-ui/lab/Rating';\r\nimport { ratings, ratingStyles } from \"../Constant\";\r\nimport { apolloClient } from \"../../../utils\";\r\nimport { GET_RATINGS_CHANNEL_BY_ID, GET_AVERAGE_RATING } from \"../../../graphql/channel/queries\";\r\nimport GradeIcon from '@material-ui/icons/Grade';\r\nimport _ from \"lodash\";\r\nimport moment from \"moment\";\r\nimport 'moment/locale/es';  // without this line it didn't work\r\nmoment.locale('vi');\r\n\r\ninterface Props {\r\n  channelId: string\r\n};\r\n\r\ninterface RatingProps {\r\n  node: {\r\n    id: string\r\n    user_id: {\r\n      id: string\r\n      first_name: string\r\n      last_name: string\r\n      avatar: string\r\n    }\r\n    ad_sell_lease_id: {\r\n      id: string\r\n      title: string\r\n    }\r\n    rate: Number\r\n    created_at: string\r\n  }\r\n};\r\n\r\ninterface AverageRating {\r\n  count_rating: number\r\n  average_point: number\r\n  five_star: number\r\n  four_star: number\r\n  three_star: number\r\n  two_star: number\r\n  one_star: number\r\n};\r\n\r\nconst avatar = \"https://1.bp.blogspot.com/-gx54Ig64I_k/WnktM_nzPXI/AAAAAAAAHgw/E7pSRwrXu_c3tSSg-vbO2iQgg4GbVxGKwCLcBGAs/s1600/anh-girl-xinh-9x-kute%2B%252811%2529.jpg\";\r\nconst Ratings: React.FunctionComponent<Props> = (props: Props) => {\r\n  const classes = ratingStyles();\r\n  const [averageRating, setAverageRating] = React.useState<AverageRating>();\r\n  const [ratingsChannel, setRatingsChannel] = React.useState<RatingProps[]>([]);\r\n  \r\n  React.useEffect(() => {\r\n    getAdChannel();\r\n    getAverageRating();\r\n  });\r\n\r\n  const getAdChannel = async () => { \r\n    let id = props.channelId;\r\n    let ratingsChannel = await apolloClient.query({ query: GET_RATINGS_CHANNEL_BY_ID, variables: {\r\n      \"id\": id,\r\n      \"limit\": 18,\r\n      \"page\": 1,\r\n    }})\r\n    .then((response: any) => {\r\n      return response.data.channelAdSellLeaseRatings.edges\r\n    });\r\n    if(Array.isArray(ratingsChannel)){\r\n      setRatingsChannel(ratingsChannel)\r\n    };\r\n  };\r\n\r\n  const getAverageRating = async () => { \r\n    let res = await apolloClient.query({ query: GET_AVERAGE_RATING, variables: {\r\n      \"id\": props.channelId\r\n    }})\r\n    .then((response: any) => {\r\n      let averageRating = _.get(response, \"data.channelAverageRatings\", {})\r\n      setAverageRating(averageRating)\r\n    });\r\n  };\r\n\r\n  const renderRating = () => {\r\n    return ratings.map((item: any, index: number) => {\r\n      return (\r\n        <div key={index}>\r\n          <CardHeader \r\n            avatar={ <Avatar alt=\"Reviewer\" src={avatar}>{item.name}</Avatar>}\r\n            disableTypography\r\n            subheader={\r\n              <div className={classes.subheader}>\r\n                <Typography variant=\"body2\" className={classes.rating}>Đánh giá bởi:</Typography>\r\n                <Typography className={classes.userRating}>{item.name}</Typography><br />\r\n                <Rating\r\n                  disabled\r\n                  name=\"simple-controlled\"\r\n                  value={item.rating}\r\n                  style={{ color: \"#045EA8\" }}\r\n                />\r\n                <Typography variant=\"body2\">{moment(item.time).fromNow()}</Typography>\r\n              </div>\r\n            }\r\n          />\r\n        </div>\r\n      )  \r\n    }) \r\n  };\r\n\r\n  const renderRatingChanel = () => {\r\n    return ratingsChannel.map((item: any, index: number) => {\r\n      return (\r\n        <div key={index}>\r\n          <CardHeader \r\n            avatar={ <Avatar alt=\"Reviewer\" src={item.node.user_id.avatar || avatar}>{item.node.user_id.avatar}</Avatar>}\r\n            disableTypography\r\n            subheader={\r\n              <div className={classes.subheader}>\r\n                <Typography variant=\"body2\" className={classes.rating}>Đánh giá bởi:</Typography>\r\n                <Typography className={classes.userRating}>{item.node.user_id.first_name} {item.node.user_id.last_name}</Typography><br />\r\n                <Rating\r\n                  disabled\r\n                  name=\"simple-controlled\"\r\n                  value={item.node.rate}\r\n                  style={{ color: \"#045EA8\" }}\r\n                />\r\n                <Typography variant=\"body2\">{moment(Number(item.node.created_at)).fromNow()}</Typography>\r\n              </div>\r\n            }\r\n          />\r\n        </div>\r\n      ) \r\n    }); \r\n  };\r\n\r\n  const count_rating   = _.get(averageRating, \"count_rating\", 1);\r\n  const fiveRating     = parseInt(`${(_.get(averageRating, \"five_star\", 0)/count_rating)*100}`);\r\n  const fourRating     = parseInt(`${(_.get(averageRating, \"four_star\", 0)/count_rating)*100}`);\r\n  const threeRating    = parseInt(`${(_.get(averageRating, \"three_star\", 0)/count_rating)*100}`);\r\n  const twoRating      = parseInt(`${(_.get(averageRating, \"two_star\", 0)/count_rating)*100}`);\r\n  const oneRating      = parseInt(`${(_.get(averageRating, \"one_star\", 0)/count_rating)*100}`);\r\n \r\n  const renderAverageRating = () => {\r\n    const total = ratingsChannel.length;\r\n    const arrTotalRating = [\r\n      { width: `${fiveRating}%` },\r\n      { width: `${fourRating}%` },\r\n      { width: `${threeRating}%` },\r\n      { width: `${twoRating}%` },\r\n      { width: `${oneRating}%` },\r\n    ];\r\n    return (\r\n      <div className={classes.averageRating}>\r\n        <div className={classes.averageRatingTotal}>\r\n          <p className={classes.averageRatingLevel}>3.0</p>\r\n          <Grid container alignItems=\"center\" justify=\"center\" spacing={0} className={classes.averageViewRating}>\r\n            <Grid item xs={8}>\r\n              <Rating disabled name=\"simple-controlled\" value={3} style={{ color: \"#045EA8\" }}/>\r\n            </Grid>\r\n            <Grid item xs={4}><Typography variant=\"h5\">{total}</Typography></Grid>\r\n          </Grid>\r\n        </div>\r\n        <div className={classes.averageRatingDescribe}>\r\n          {arrTotalRating.map((item: any, index: number) => {\r\n            return (\r\n              <div  style={{ marginLeft: 20 }}>\r\n                <div className={classes.levelRating}>\r\n                  {5 - index}\r\n                  <GradeIcon className={classes.levelRatingIcon} />\r\n                </div>\r\n                <div className={classes.averageRatingDescribeFive} key={index} \r\n                  style={{ marginLeft: 40 }}\r\n                >\r\n                  <div className={classes.averageRatingDescribeFiveLevel} style= {{ width: item.width }}></div>\r\n                </div>\r\n              </div>\r\n            )\r\n          })}\r\n        </div>\r\n        <div style={{ clear: \"both\" }}></div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className={classes.rootRating}>\r\n      <Typography variant=\"h5\" className={classes.titleRating}>Đánh giá chất lượng</Typography>\r\n      {renderAverageRating()}\r\n      <div className={classes.ratingList}>\r\n        <Typography variant=\"h5\" className={classes.titleRating}>Đánh giá gần nhất</Typography>\r\n        {Array.isArray(ratings) ? renderRatingChanel() : <Typography align=\"center\">Không có đánh giá nào</Typography> }\r\n        {/* {Array.isArray(ratings) ? renderRating() : <Typography align=\"center\">Không có đánh giá nào</Typography> } */}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\nexport default Ratings;"]},"metadata":{},"sourceType":"module"}