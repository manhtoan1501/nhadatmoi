{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from 'react';\nimport { Button, Typography, Popover, ListItem, ListItemText, ListItemIcon, Grow, Paper, Popper, MenuItem, MenuList, Hidden } from '@material-ui/core';\nimport Link from 'next/link';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport Validator from \"../../modules/validator\";\nimport SearchIcon from '@material-ui/icons/Search';\nimport { localStorageSearch } from \"../../constants\";\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\nimport { apolloClient } from \"../../utils\";\nimport { GET_PROJECT_LIST_NAME } from \"../../graphql/project/queries\";\nimport { GET_AD_SELL_LEASES } from \"../../graphql/ad_sell_leases/queries\";\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport EcoIcon from '@material-ui/icons/Eco';\nimport ViewList from '@material-ui/icons/ViewList';\nimport InputBase from \"@material-ui/core/InputBase\";\nimport Router from \"next/router\";\nvar useStyles = makeStyles(function (theme) {\n  var _placementHeaderSearc, _placementHomeSearch;\n\n  return createStyles({\n    root: {\n      display: 'flex'\n    },\n    placementHeaderSearch: (_placementHeaderSearc = {\n      width: \"100%\"\n    }, _defineProperty(_placementHeaderSearc, theme.breakpoints.up('sm'), {\n      marginLeft: \"-40px\"\n    }), _defineProperty(_placementHeaderSearc, theme.breakpoints.down('xs'), {}), _placementHeaderSearc),\n    placementHomeSearch: (_placementHomeSearch = {\n      width: \"100%\",\n      paddingTop: \"12px\",\n      zIndex: 1000\n    }, _defineProperty(_placementHomeSearch, theme.breakpoints.up('lg'), {\n      width: \"calc(100% - 40px)\",\n      marginLeft: \"-200px\"\n    }), _defineProperty(_placementHomeSearch, theme.breakpoints.up('md'), {\n      width: \"calc(100% - 40px)\",\n      marginLeft: \"-200px\"\n    }), _defineProperty(_placementHomeSearch, theme.breakpoints.up('sm'), {\n      width: \"calc(100% - 40px)\",\n      marginLeft: \"-200px\"\n    }), _defineProperty(_placementHomeSearch, theme.breakpoints.down('sm'), {\n      width: \"calc(100% - 40px)\",\n      paddingTop: \"7px\" // marginLeft: \"4px\"\n\n    }), _placementHomeSearch),\n    paper: {\n      marginRight: theme.spacing(2)\n    },\n    fontMenuItem: {\n      fontWeight: 900,\n      fontSize: \"15px\"\n    },\n    positionDelete: {\n      position: \"absolute\",\n      right: \"10px\",\n      color: \"red\",\n      textAlign: \"right\",\n      fontSize: \"14px\"\n    },\n    positionSearchHome: {}\n  });\n});\nvar theme = createMuiTheme({\n  overrides: {\n    MuiMenuItem: {\n      root: {\n        lineHeight: 1,\n        fontSize: \"14px\",\n        minHeight: \"30px\"\n      }\n    }\n  }\n});\nvar projectHot = [{\n  title: \"Vinhomes Central Park\",\n  type: \"/du-an-bat-dong-san\"\n}, {\n  title: \"Vinhomes Grand Park\",\n  type: \"/du-an-bat-dong-san\"\n}, {\n  title: \"Vinhomes Smart City\",\n  type: \"/du-an-bat-dong-san\"\n}, {\n  title: \"Nhà Đất Hải Phòng\",\n  type: \"/nha-dat-ban\"\n}, {\n  title: \"Nhà Đất Hà Nội\",\n  type: \"/nha-dat-ban\"\n}];\nvar historySearch = new Array();\n\nvar MenuListComposition = function MenuListComposition(props) {\n  var classes = useStyles();\n\n  var _useState = useState(false),\n      open = _useState[0],\n      setOpen = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      keywordSearch = _useState2[0],\n      setKeywordSearch = _useState2[1];\n\n  var anchorRef = React.useRef(null);\n\n  var _useState3 = useState(),\n      projectSearch = _useState3[0],\n      setProjectSearch = _useState3[1];\n\n  var _useState4 = useState(),\n      adSellLeasesSearch = _useState4[0],\n      setAdSellLeasesSearch = _useState4[1];\n\n  var _React$useState = React.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      anchorElSearchType = _React$useState2[0],\n      setAnchorElSearchType = _React$useState2[1];\n\n  var AD = 'tin-rao';\n  var AD_HOUSING = 'nha-dat-ban';\n  var PROJECT_HOUSING = 'du-an-bat-dong-san';\n  var PROJECT = 'du-an';\n  var dropdownSearch = [{\n    title: 'Dự án',\n    type: PROJECT_HOUSING\n  }, {\n    title: 'Tin rao',\n    type: AD_HOUSING\n  }];\n  var pathProps = props.path;\n  var defaultDropdown = dropdownSearch[0];\n\n  if (pathProps === AD || pathProps === AD_HOUSING) {\n    defaultDropdown = dropdownSearch[1];\n  }\n\n  var _React$useState3 = React.useState(defaultDropdown),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      typeSearch = _React$useState4[0],\n      setTypeSearch = _React$useState4[1];\n\n  var handleToggle = function handleToggle() {\n    setOpen(function (prevOpen) {\n      return !prevOpen;\n    });\n  };\n\n  function handleListKeyDown(event) {\n    if (event.key === 'Tab') {\n      event.preventDefault();\n      setOpen(false);\n    }\n  }\n\n  var removeLocalSearch = function removeLocalSearch() {\n    localStorage.removeItem(localStorageSearch);\n    setOpen(false);\n    setKeywordSearch(\"\");\n  };\n\n  var _id = open ? 'simple-popover' : undefined;\n\n  var prevOpen = React.useRef(open);\n  useEffect(function () {\n    historySearch = JSON.parse(localStorage.getItem(localStorageSearch));\n    if (!Array.isArray(historySearch)) historySearch = [];\n\n    if (!Validator.isBlank(localStorage.getItem(localStorageSearch))) {\n      localStorage.setItem(localStorageSearch, JSON.stringify(historySearch));\n    }\n\n    if (prevOpen.current === true && open === false) {// anchorRef.current.focus();\n    }\n\n    prevOpen.current = open;\n  }, [open]);\n\n  var _onBlur = function onBlur(e) {\n    if (e.target.value) {\n      saveLocalStorege(e);\n    }\n  };\n\n  var handleKeyDownSearch = function handleKeyDownSearch(e) {\n    if (e.key == \"Enter\" || e.keyCode == 13) {\n      saveLocalStorege(e);\n    }\n  };\n\n  var saveLocalStorege = function saveLocalStorege(e) {\n    if (!Array.isArray(historySearch)) historySearch = [];\n    var checkExist = false;\n    historySearch.map(function (item) {\n      if (item && item.title === e.target.value) {\n        checkExist = true;\n      }\n    });\n\n    if (!checkExist || historySearch.length == 0) {\n      historySearch.unshift({\n        title: e.target.value,\n        type: \"/\".concat(typeSearch.type)\n      });\n    }\n\n    if (historySearch.length >= 4) {\n      historySearch.splice(3, 1);\n    }\n\n    localStorage.setItem(localStorageSearch, JSON.stringify(historySearch));\n  };\n\n  var onClickSearch = function onClickSearch(title, type) {\n    setKeywordSearch(\"\");\n    setOpen(false);\n    var urlProcess = {\n      pathname: \"\".concat(type),\n      query: {\n        name: title\n      }\n    };\n    var slugAs = \"\".concat(type, \"?name=\") + title;\n    Router.push(urlProcess, slugAs, {\n      shallow: false\n    });\n  };\n\n  var onChangeSearch = function onChangeSearch(e) {\n    if (e.key == \"Enter\" || e.keyCode == 13) {\n      buttonSearch(0, 0);\n    }\n\n    setKeywordSearch(e.target.value);\n    var filterProject = {\n      name: e.target.value\n    };\n    var filterAdSellLeases = {\n      title: e.target.value\n    };\n    var dataFilterProject = JSON.stringify(filterProject);\n    var dataFilterAdSellLeases = JSON.stringify(filterAdSellLeases);\n    var limit = pathProps == AD || pathProps == AD_HOUSING || pathProps == PROJECT_HOUSING || pathProps == PROJECT ? 10 : 4; // get tin rao\n\n    if (pathProps == \"\") {\n      limit = 10;\n    }\n\n    if (typeSearch.type == PROJECT || typeSearch.type == PROJECT_HOUSING) {\n      // get du an\n      apolloClient.query({\n        query: GET_PROJECT_LIST_NAME,\n        variables: {\n          \"page\": 1,\n          \"limit\": limit,\n          \"filter\": dataFilterProject\n        }\n      }).then(function (response) {\n        setProjectSearch(response.data.projects.edges);\n      });\n    }\n\n    if (typeSearch.type == AD || typeSearch.type == AD_HOUSING) {\n      // get tin rao\n      apolloClient.query({\n        query: GET_AD_SELL_LEASES,\n        variables: {\n          \"page\": 1,\n          \"limit\": limit,\n          \"filter\": dataFilterAdSellLeases\n        }\n      }).then(function (response) {\n        setAdSellLeasesSearch(response.data.adSellLeases.edges);\n      });\n    }\n  };\n\n  var buttonSearch = function buttonSearch(typeRequest, keySearch) {\n    var key = keywordSearch;\n\n    if (typeof keySearch == \"string\") {\n      key = keySearch;\n    }\n\n    if (typeSearch.type === AD_HOUSING) {\n      var urlProcess = {\n        pathname: '/nha-dat-ban',\n        query: {\n          title: key\n        }\n      };\n      var slugAs = '/nha-dat-ban?title=' + key;\n      Router.push(urlProcess, slugAs, {\n        shallow: false\n      });\n    } else {\n      var _urlProcess = {\n        pathname: '/du-an-bat-dong-san',\n        query: {\n          name: key\n        }\n      };\n\n      var _slugAs = '/du-an-bat-dong-san?name=' + key;\n\n      Router.push(_urlProcess, _slugAs, {\n        shallow: false\n      });\n    }\n  };\n\n  var handleClickSearchType = function handleClickSearchType(event) {\n    setAnchorElSearchType(event.currentTarget);\n  };\n\n  var handleChangeType = function handleChangeType(inputType) {\n    setTypeSearch(inputType);\n    handleCloseSearchType();\n  };\n\n  var handleCloseSearchType = function handleCloseSearchType() {\n    setAnchorElSearchType(null);\n  };\n\n  var onChangeWards = function onChangeWards(event) {\n    setKeywordSearch(event.target.value);\n\n    if (event.key == \"Enter\" || event.keyCode == 13) {\n      buttonSearch(0, 0);\n    }\n  };\n\n  var openSearchType = Boolean(anchorElSearchType);\n  var converProject = new Array();\n  var convetAdSellLeases = new Array();\n\n  if (Array.isArray(projectSearch)) {\n    projectSearch.map(function (item) {\n      converProject.push({\n        title: item.node.name,\n        type: \"/du-an-bat-dong-san\"\n      });\n    });\n  }\n\n  if (Array.isArray(adSellLeasesSearch)) {\n    adSellLeasesSearch.map(function (item) {\n      convetAdSellLeases.push({\n        title: item.node.title,\n        type: \"/nha-dat-ban\"\n      });\n    });\n  }\n\n  var renderNewSearch = typeSearch.type == AD || typeSearch.type == AD_HOUSING ? __jsx(React.Fragment, null, __jsx(MenuList, {\n    id: \"menu-list-grow\",\n    onKeyDown: handleListKeyDown\n  }, __jsx(MenuItem, {\n    key: \"tinrao\"\n  }, __jsx(Typography, {\n    className: classes.fontMenuItem\n  }, \"TIN RAO\")), convetAdSellLeases.map(function (item, index) {\n    return __jsx(MenuItem, {\n      key: index,\n      onClick: function onClick() {\n        return onClickSearch(item.title, item.type);\n      }\n    }, item.title);\n  }))) : typeSearch.type == PROJECT || typeSearch.type == PROJECT_HOUSING ? __jsx(MenuList, {\n    id: \"menu-list-grow\",\n    onKeyDown: handleListKeyDown\n  }, __jsx(MenuItem, null, __jsx(Typography, {\n    className: classes.fontMenuItem\n  }, \"D\\u1EF0 \\xC1N\")), converProject.map(function (item, index) {\n    return __jsx(MenuItem, {\n      key: index,\n      onClick: function onClick() {\n        return onClickSearch(item.title, item.type);\n      }\n    }, item.title);\n  })) : __jsx(MenuList, {\n    id: \"menu-list-grow\",\n    onKeyDown: handleListKeyDown\n  }, __jsx(MenuItem, null, __jsx(Typography, {\n    className: classes.fontMenuItem\n  }, \"TIN RAO\")), convetAdSellLeases.map(function (item, index) {\n    return __jsx(MenuItem, {\n      key: index,\n      onClick: function onClick() {\n        return onClickSearch(item.title, item.type);\n      }\n    }, item.title);\n  }), __jsx(MenuItem, null, __jsx(Typography, {\n    className: classes.fontMenuItem\n  }, \"D\\u1EF0 \\xC1N\")), converProject.map(function (item, index) {\n    return __jsx(MenuItem, {\n      key: index,\n      onClick: function onClick() {\n        return onClickSearch(item.title, item.type);\n      }\n    }, item.title);\n  }));\n  var renderHot = projectHot.map(function (item, index) {\n    return __jsx(MenuItem, {\n      key: index,\n      onClick: function onClick() {\n        return onClickSearch(item.title, item.type);\n      }\n    }, __jsx(Link, {\n      href: \"\".concat(item.type)\n    }, __jsx(\"a\", {\n      style: {\n        color: \"black\"\n      }\n    }, item.title)));\n  });\n  var renderHistory = historySearch.map(function (item, index) {\n    return __jsx(MenuItem, {\n      key: index + 10,\n      onClick: function onClick() {\n        return onClickSearch(item.title, item.type);\n      }\n    }, item.title);\n  });\n\n  var renderSearchHeader = __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"header__center__search__icon\"\n  }, __jsx(\"svg\", {\n    viewBox: \"0 0 512 512\"\n  }, __jsx(\"path\", {\n    d: \"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z\"\n  }))), __jsx(\"div\", {\n    className: \"header__center__search__box\"\n  }, __jsx(InputBase, {\n    fullWidth: true,\n    placeholder: \"T\\xECm ki\\u1EBFm ... \",\n    defaultValue: keywordSearch // value={keywordSearch}\n    ,\n    onKeyDown: handleKeyDownSearch,\n    autoComplete: \"off\",\n    ref: anchorRef,\n    onChange: function onChange(e) {\n      return onChangeSearch(e);\n    },\n    onBlur: function onBlur(e) {\n      return _onBlur(e);\n    },\n    onClick: handleToggle,\n    onKeyUp: function onKeyUp(e) {\n      return onChangeWards(e);\n    }\n  })), __jsx(\"div\", {\n    className: \"header__center__search__type\"\n  }, __jsx(Button, {\n    onClick: handleClickSearchType,\n    \"aria-describedby\": _id\n  }, __jsx(\"svg\", {\n    viewBox: \"0 0 320 512\"\n  }, __jsx(\"path\", {\n    d: \"M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z\"\n  })), typeSearch.title), __jsx(Popover, {\n    id: _id,\n    open: openSearchType,\n    anchorEl: anchorElSearchType,\n    onClose: handleCloseSearchType,\n    anchorOrigin: {\n      vertical: 'bottom',\n      horizontal: 'center'\n    },\n    transformOrigin: {\n      vertical: 'top',\n      horizontal: 'center'\n    },\n    className: \"header__center__search__type__popup\"\n  }, __jsx(Typography, {\n    component: 'span'\n  }, __jsx(ListItem, {\n    button: true,\n    onClick: function onClick(event) {\n      return handleChangeType(dropdownSearch[0]);\n    }\n  }, __jsx(ListItemIcon, null, __jsx(EcoIcon, null)), __jsx(ListItemText, {\n    primary: dropdownSearch[0].title\n  })), __jsx(ListItem, {\n    button: true,\n    onClick: function onClick(event) {\n      return handleChangeType(dropdownSearch[1]);\n    }\n  }, __jsx(ListItemIcon, null, __jsx(ViewList, null)), __jsx(ListItemText, {\n    primary: dropdownSearch[1].title\n  }))))), __jsx(Button, {\n    variant: \"outlined\",\n    onClick: function onClick() {\n      return buttonSearch(0, 0);\n    },\n    className: \"header__center__search__button\"\n  }, __jsx(\"svg\", {\n    viewBox: \"0 0 512 512\"\n  }, __jsx(\"path\", {\n    d: \"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z\"\n  }))));\n\n  var renderSearchHome = __jsx(React.Fragment, null, __jsx(Hidden, {\n    xsDown: true\n  }, __jsx(\"div\", {\n    className: \"search_homepage__body__box__select\"\n  }, __jsx(Button, {\n    onClick: handleClickSearchType,\n    \"aria-describedby\": _id\n  }, typeSearch.title, __jsx(\"svg\", {\n    viewBox: \"0 0 320 512\"\n  }, __jsx(\"path\", {\n    d: \"M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z\"\n  }))), __jsx(Popover, {\n    id: _id,\n    open: openSearchType,\n    anchorEl: anchorElSearchType,\n    onClose: handleCloseSearchType,\n    anchorOrigin: {\n      vertical: 'bottom',\n      horizontal: 'center'\n    },\n    transformOrigin: {\n      vertical: 'top',\n      horizontal: 'center'\n    },\n    className: \"search_homepage__body__box__select__popup\"\n  }, __jsx(Typography, {\n    component: 'span'\n  }, __jsx(ListItem, {\n    button: true,\n    onClick: function onClick(event) {\n      return handleChangeType(dropdownSearch[0]);\n    }\n  }, __jsx(ListItemIcon, null, __jsx(EcoIcon, null)), __jsx(ListItemText, {\n    primary: dropdownSearch[0].title\n  })), __jsx(ListItem, {\n    button: true,\n    onClick: function onClick(event) {\n      return handleChangeType(dropdownSearch[1]);\n    }\n  }, __jsx(ListItemIcon, null, __jsx(ViewList, null)), __jsx(ListItemText, {\n    primary: dropdownSearch[1].title\n  })))))), __jsx(\"div\", {\n    className: \"search_homepage__body_box_input\"\n  }, __jsx(InputBase, {\n    fullWidth: true,\n    placeholder: \"Nh\\u1EADp th\\xF4ng tin t\\xECm ki\\u1EBFm ... \",\n    className: \"search_homepage__body_box_input_base\",\n    defaultValue: keywordSearch,\n    autoComplete: \"off\",\n    ref: anchorRef,\n    onChange: function onChange(e) {\n      return onChangeSearch(e);\n    },\n    onBlur: function onBlur(e) {\n      return _onBlur(e);\n    },\n    onClick: handleToggle,\n    onKeyUp: function onKeyUp(e) {\n      return onChangeWards(e);\n    }\n  })), __jsx(Button, {\n    variant: \"outlined\",\n    onClick: function onClick() {\n      return buttonSearch(0, 0);\n    },\n    className: \"search_homepage__body_box_button\"\n  }, __jsx(SearchIcon, null)));\n\n  var renderHotHistory = __jsx(MenuList, {\n    id: \"menu-list-grow\",\n    onKeyDown: handleListKeyDown\n  }, __jsx(MenuItem, {\n    key: \"tukhoahot\"\n  }, \" \", __jsx(Typography, {\n    className: classes.fontMenuItem\n  }, \"T\\u1EEA KH\\xD3A HOT\")), renderHot, __jsx(MenuItem, {\n    key: \"lichsutimkiem\"\n  }, __jsx(Typography, {\n    className: classes.fontMenuItem\n  }, \"L\\u1ECACH S\\u1EEC T\\xCCM KI\\u1EBEM\"), __jsx(Typography, {\n    className: classes.positionDelete,\n    onClick: removeLocalSearch\n  }, \"X\\xF3a\")), renderHistory);\n\n  return __jsx(\"div\", null, __jsx(\"div\", {\n    style: {\n      minHeight: '30px'\n    }\n  }, props.searchLocation == 'header' ? renderSearchHeader : renderSearchHome), __jsx(ThemeProvider, {\n    theme: theme\n  }, __jsx(Popper, {\n    className: props.searchLocation == 'header' ? classes.placementHeaderSearch : classes.placementHomeSearch,\n    placement: \"bottom-start\",\n    open: open,\n    anchorEl: anchorRef.current,\n    role: undefined,\n    transition: true,\n    disablePortal: true\n  }, function (_ref) {\n    var TransitionProps = _ref.TransitionProps,\n        placement = _ref.placement;\n    return __jsx(Grow, _extends({}, TransitionProps, {\n      style: {\n        transformOrigin: placement === 'bottom' ? 'left top' : 'center bottom'\n      }\n    }), __jsx(Paper, null, __jsx(ClickAwayListener, {\n      onClickAway: function onClickAway() {\n        return setOpen(false);\n      }\n    }, keywordSearch ? renderNewSearch : renderHotHistory)));\n  })));\n};\n\nexport default MenuListComposition;","map":null,"metadata":{},"sourceType":"module"}