{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nvar _jsxFileName = \"C:\\\\Users\\\\manh nhan\\\\Desktop\\\\data\\\\chat\\\\components\\\\PageDetail\\\\TitleBlock.tsx\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport ReplyIcon from '@material-ui/icons/Reply';\nimport FavoriteIcon from '@material-ui/icons/Favorite';\nimport PlaylistAddIcon from '@material-ui/icons/PlaylistAdd';\nimport ReportIcon from '@material-ui/icons/Report';\nimport Moment from 'react-moment';\nimport Button from \"@material-ui/core/Button\";\nimport dynamic from \"next/dynamic\";\nimport Validator from \"../../modules/validator\";\nimport Tracking from \"../../modules/AdSellLease/Tracking\";\nimport validator from \"../../modules/validator\";\nimport { apolloClient } from \"../../utils\";\nimport { ADD_AD_SELL_LEASE_WISH_LIST } from \"../../graphql/ad_sell_leases/mutation\";\nimport { ADD_PROJECT_WISH_LIST } from \"../../graphql/project/mutation\";\nimport Router from \"next/router\";\nimport { adSellLeaseCategory, localStorageCompareKey, adSellLeaseType } from '../../constants';\nimport Breadcrumbs from '../LayeredNavigation/Breadcrumbs';\nconst SharePopup = dynamic(() => import('../Share/Share'), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('../Share/Share')],\n    modules: ['../Share/Share']\n  }\n});\n\nconst TitleBlock = props => {\n  const [likeStatus, setLikeStatus] = React.useState(props.dataObject.like_status);\n\n  const handleTracking = type => {\n    let addSellLeaseId = props.dataObject.id;\n\n    if (addSellLeaseId && !validator.isBlank(addSellLeaseId) && props.type === 'ad_sell_lease') {\n      Tracking.addTracking(String(addSellLeaseId), type);\n    }\n  };\n\n  let title = '';\n\n  if (props.dataObject && props.dataObject.title) {\n    title = props.dataObject.title;\n  }\n\n  if (props.dataObject && props.dataObject.name) {\n    title = props.dataObject.name;\n  }\n\n  if (title && !Validator.isBlank(title)) {\n    let titleObject = title.split(' ');\n\n    for (let index in titleObject) {\n      if (titleObject[index] && !Validator.isBlank(titleObject[index])) {\n        let checkPhoneNumber = titleObject[index];\n\n        if (isValid(checkPhoneNumber)) {\n          titleObject[index] = '**********';\n        }\n      }\n    }\n\n    title = titleObject.join(' ');\n  }\n\n  function isValid(value) {\n    let regex = /^[\\+]?[(]?[0-9]{3}[)]?[-\\s\\.]?[0-9]{3}[-\\s\\.]?[0-9]{4,6}$/im;\n    return regex.test(value);\n  }\n\n  let id = '';\n\n  if (props.dataObject && props.dataObject.id) {\n    id = props.dataObject.id;\n  }\n\n  const dataPrepare = {\n    avatar: props.image,\n    title: title,\n    id: id,\n    type: props.type\n  };\n\n  let clickAddToCompare = () => {\n    handleTracking('compare_click');\n    let statusUpdate = updateCompareData(dataPrepare);\n    if (!statusUpdate) return statusUpdate;\n\n    if (props.type === 'project') {\n      Router.replace('/du-an-bat-dong-san', '/du-an-bat-dong-san', {\n        shallow: true\n      });\n    } else {\n      Router.replace('/[slug]', '/tim-tin-rao', {\n        shallow: true\n      });\n    }\n  };\n\n  let updateCompareData = data => {\n    let dataToCompare = [];\n    let isAddToLocal = true;\n\n    if (localStorage.getItem(localStorageCompareKey) && !Validator.isBlank(localStorage.getItem(localStorageCompareKey))) {\n      dataToCompare = JSON.parse(localStorage.getItem(localStorageCompareKey));\n\n      for (let index in dataToCompare) {\n        if (dataToCompare[index].id === data.id) {\n          isAddToLocal = false;\n        }\n\n        if (dataToCompare[index].type !== data.type) {\n          localStorage.removeItem(localStorageCompareKey);\n          dataToCompare = [];\n          break;\n        }\n      }\n    }\n\n    let screenWidth = screen.width;\n\n    if (dataToCompare && dataToCompare.length && dataToCompare.length >= 4 && screenWidth > 599) {\n      alert(\"Không thể so sánh quá 4 sản phẩm!\");\n      return false;\n    }\n\n    if (dataToCompare && dataToCompare.length && dataToCompare.length >= 2 && screenWidth <= 599) {\n      alert(\"Không thể so sánh quá 2 sản phẩm!\");\n      return false;\n    }\n\n    if (isAddToLocal) {\n      dataToCompare.push(data);\n      localStorage.setItem(localStorageCompareKey, _JSON$stringify(dataToCompare));\n    }\n\n    return true;\n  };\n\n  const [statusShare, setStatusShare] = React.useState(false);\n\n  const handleShare = status => {\n    setStatusShare(status);\n    handleTracking('share_click');\n  };\n\n  const handleFavorite = status => {\n    if (likeStatus) {\n      return false;\n    } else {\n      setLikeStatus(true);\n    }\n\n    handleTracking('like');\n    alert(\"Đã thêm vào danh sách Yêu thích\");\n\n    if (props.type === 'project') {\n      apolloClient.mutate({\n        mutation: ADD_PROJECT_WISH_LIST,\n        variables: {\n          \"input\": {\n            \"project_id\": props.dataObject.id,\n            \"status\": \"like\"\n          }\n        }\n      }).then(response => {});\n    } else {\n      apolloClient.mutate({\n        mutation: ADD_AD_SELL_LEASE_WISH_LIST,\n        variables: {\n          \"input\": {\n            \"ad_sell_lease_id\": props.dataObject.id,\n            \"status\": \"like\"\n          }\n        }\n      }).then(response => {});\n    }\n  };\n\n  const handleReport = () => {\n    handleTracking('report');\n    alert(\"Đã báo cáo thành công!\");\n  };\n\n  const dataBreadcrumbs = [];\n  let dataType1Breadcrumbs = {\n    href: '',\n    href_as: '',\n    name: ''\n  };\n  let dataType2Breadcrumbs = {\n    href: '',\n    href_as: '',\n    name: ''\n  };\n\n  for (let index in adSellLeaseCategory) {\n    if (props.dataObject.type && props.dataObject.type.type1 === adSellLeaseCategory[index].id) {\n      dataType1Breadcrumbs = {\n        href: '/slug',\n        href_as: adSellLeaseCategory[index].slug,\n        name: adSellLeaseCategory[index].name\n      };\n    }\n  }\n\n  for (let index in adSellLeaseType) {\n    if (props.dataObject.type && adSellLeaseType[index].id.indexOf(props.dataObject.type.type2) !== -1) {\n      dataType2Breadcrumbs = {\n        href: '/slug',\n        href_as: adSellLeaseType[index].slug,\n        name: adSellLeaseType[index].name\n      };\n    }\n  }\n\n  if (!Validator.isBlank(dataType1Breadcrumbs.href_as)) {\n    dataBreadcrumbs.push(dataType1Breadcrumbs);\n  }\n\n  if (!Validator.isBlank(dataType2Breadcrumbs.href_as)) {\n    dataBreadcrumbs.push(dataType2Breadcrumbs);\n  }\n\n  return __jsx(\"div\", {\n    className: \"title-project\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206\n    },\n    __self: this\n  }, __jsx(Breadcrumbs, {\n    dataBreadcrumbs: dataBreadcrumbs,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207\n    },\n    __self: this\n  }), __jsx(\"h1\", {\n    className: \"title-project__title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208\n    },\n    __self: this\n  }, title), props.dataObject && props.dataObject.address && props.dataObject.address.text && __jsx(\"div\", {\n    className: \"title-project__address\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211\n    },\n    __self: this\n  }, \"\\u0110\\u1ECBa ch\\u1EC9: \", props.dataObject.address.text), __jsx(\"div\", {\n    className: \"title-project__bottom\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"title-project__bottom__share\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: likeStatus ? \"title-project__bottom__share__item active\" : \"title-project__bottom__share__item\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  }, __jsx(Button, {\n    onClick: () => handleFavorite(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218\n    },\n    __self: this\n  }, __jsx(FavoriteIcon, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219\n    },\n    __self: this\n  }), \" Y\\xEAu th\\xEDch\")), __jsx(\"div\", {\n    className: \"title-project__bottom__share__item\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222\n    },\n    __self: this\n  }, __jsx(Button, {\n    onClick: () => handleShare(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223\n    },\n    __self: this\n  }, __jsx(ReplyIcon, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224\n    },\n    __self: this\n  }), \" Chia s\\u1EBB\")), __jsx(\"div\", {\n    className: \"title-project__bottom__share__item\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227\n    },\n    __self: this\n  }, __jsx(Button, {\n    onClick: () => clickAddToCompare(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228\n    },\n    __self: this\n  }, __jsx(PlaylistAddIcon, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229\n    },\n    __self: this\n  }), \" So s\\xE1nh\")), __jsx(\"div\", {\n    className: \"title-project__bottom__share__item\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232\n    },\n    __self: this\n  }, __jsx(Button, {\n    onClick: () => handleReport(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233\n    },\n    __self: this\n  }, __jsx(ReportIcon, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234\n    },\n    __self: this\n  }), \" B\\xE1o c\\xE1o\"))), __jsx(\"div\", {\n    className: \"title-project__bottom__publish\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239\n    },\n    __self: this\n  }, props.dataObject && props.dataObject.view_count ? props.dataObject.view_count + ' lượt xem - ' : '', props.dataObject && __jsx(React.Fragment, null, \"Ng\\xE0y \\u0111\\u0103ng \", __jsx(Moment, {\n    unix: true,\n    format: \"DD/MM/YYYY\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243\n    },\n    __self: this\n  }, Number(props.dataObject.created_at) / 1000))), __jsx(SharePopup, {\n    onClose: () => setStatusShare(false),\n    statusModal: statusShare,\n    objectUrl: props.objectUrl,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249\n    },\n    __self: this\n  })));\n};\n\nexport default TitleBlock;","map":{"version":3,"sources":["C:/Users/manh nhan/Desktop/data/chat/components/PageDetail/TitleBlock.tsx"],"names":["React","ReplyIcon","FavoriteIcon","PlaylistAddIcon","ReportIcon","Moment","Button","dynamic","Validator","Tracking","validator","apolloClient","ADD_AD_SELL_LEASE_WISH_LIST","ADD_PROJECT_WISH_LIST","Router","adSellLeaseCategory","localStorageCompareKey","adSellLeaseType","Breadcrumbs","SharePopup","ssr","TitleBlock","props","likeStatus","setLikeStatus","useState","dataObject","like_status","handleTracking","type","addSellLeaseId","id","isBlank","addTracking","String","title","name","titleObject","split","index","checkPhoneNumber","isValid","join","value","regex","test","dataPrepare","avatar","image","clickAddToCompare","statusUpdate","updateCompareData","replace","shallow","data","dataToCompare","isAddToLocal","localStorage","getItem","JSON","parse","removeItem","screenWidth","screen","width","length","alert","push","setItem","statusShare","setStatusShare","handleShare","status","handleFavorite","mutate","mutation","variables","then","response","handleReport","dataBreadcrumbs","dataType1Breadcrumbs","href","href_as","dataType2Breadcrumbs","type1","slug","indexOf","type2","address","text","view_count","Number","created_at","objectUrl"],"mappings":"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","sourcesContent":["import React, {FunctionComponent} from \"react\";\r\nimport ReplyIcon from '@material-ui/icons/Reply';\r\nimport FavoriteIcon from '@material-ui/icons/Favorite';\r\nimport PlaylistAddIcon from '@material-ui/icons/PlaylistAdd';\r\nimport ReportIcon from '@material-ui/icons/Report';\r\nimport Moment from 'react-moment';\r\nimport Button from \"@material-ui/core/Button\";\r\nimport dynamic from \"next/dynamic\";\r\nimport {AdSellLeaseItem} from '../../interfaces/adSellLeaseItem';\r\nimport Validator from \"../../modules/validator\";\r\nimport Tracking from \"../../modules/AdSellLease/Tracking\";\r\nimport validator from \"../../modules/validator\";\r\nimport {apolloClient} from \"../../utils\";\r\nimport {ADD_AD_SELL_LEASE_WISH_LIST} from \"../../graphql/ad_sell_leases/mutation\";\r\nimport {ADD_PROJECT_WISH_LIST} from \"../../graphql/project/mutation\";\r\nimport Router from \"next/router\";\r\nimport {adSellLeaseCategory, localStorageCompareKey, adSellLeaseType} from '../../constants';\r\nimport Breadcrumbs from '../LayeredNavigation/Breadcrumbs';\r\nconst SharePopup = dynamic(() => import('../Share/Share'), {\r\n  ssr: false\r\n});\r\n\r\ninterface ProjectMainProps {\r\n  dataObject: AdSellLeaseItem,\r\n  objectUrl: string,\r\n  type: string,\r\n  image: string,\r\n}\r\n\r\ninterface CompareDataProps {\r\n  avatar: string,\r\n  title: string,\r\n  id: string,\r\n  type: string\r\n}\r\n\r\nconst TitleBlock: FunctionComponent<ProjectMainProps> = (props: ProjectMainProps) =>\r\n{\r\n  const [likeStatus, setLikeStatus] = React.useState(props.dataObject.like_status);\r\n\r\n  const handleTracking = (type: string) => {\r\n    let addSellLeaseId = props.dataObject.id;\r\n    if (addSellLeaseId && !validator.isBlank(addSellLeaseId) && props.type === 'ad_sell_lease') {\r\n      Tracking.addTracking(String(addSellLeaseId), type);\r\n    }\r\n  };\r\n\r\n  let title = '';\r\n  if (props.dataObject && props.dataObject.title) {\r\n    title = props.dataObject.title;\r\n  }\r\n  if (props.dataObject && props.dataObject.name) {\r\n    title = props.dataObject.name;\r\n  }\r\n\r\n  if (title && !Validator.isBlank(title)) {\r\n    let titleObject = title.split(' ');\r\n    for (let index in titleObject) {\r\n      if (titleObject[index] && !Validator.isBlank(titleObject[index])) {\r\n        let checkPhoneNumber = titleObject[index];\r\n        if (isValid(checkPhoneNumber)) {\r\n          titleObject[index] = '**********';\r\n        }\r\n      }\r\n    }\r\n    title = titleObject.join(' ');\r\n  }\r\n\r\n  function isValid(value: string) {\r\n    let regex = /^[\\+]?[(]?[0-9]{3}[)]?[-\\s\\.]?[0-9]{3}[-\\s\\.]?[0-9]{4,6}$/im;\r\n    return regex.test(value);\r\n  }\r\n\r\n  let id = '';\r\n  if (props.dataObject && props.dataObject.id) {\r\n    id = props.dataObject.id;\r\n  }\r\n  const dataPrepare = {\r\n    avatar: props.image,\r\n    title: title,\r\n    id: id,\r\n    type: props.type\r\n  };\r\n  let clickAddToCompare = () => {\r\n    handleTracking('compare_click');\r\n    let statusUpdate = updateCompareData(dataPrepare);\r\n    if (!statusUpdate) return statusUpdate;\r\n    if (props.type === 'project') {\r\n      Router.replace('/du-an-bat-dong-san', '/du-an-bat-dong-san', { shallow: true });\r\n    } else {\r\n      Router.replace('/[slug]', '/tim-tin-rao', { shallow: true });\r\n    }\r\n  };\r\n\r\n  let updateCompareData = (data: CompareDataProps) => {\r\n    let dataToCompare = [];\r\n    let isAddToLocal = true;\r\n    if (localStorage.getItem(localStorageCompareKey) && !Validator.isBlank(localStorage.getItem(localStorageCompareKey))) {\r\n      dataToCompare = JSON.parse(localStorage.getItem(localStorageCompareKey) as string);\r\n      for (let index in dataToCompare) {\r\n        if (dataToCompare[index].id === data.id) {\r\n          isAddToLocal = false;\r\n        }\r\n        if (dataToCompare[index].type !== data.type) {\r\n          localStorage.removeItem(localStorageCompareKey);\r\n          dataToCompare = [];\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    let screenWidth = screen.width;\r\n    if (dataToCompare && dataToCompare.length && dataToCompare.length >= 4 && screenWidth > 599) {\r\n      alert(\"Không thể so sánh quá 4 sản phẩm!\");\r\n      return false;\r\n    }\r\n    if (dataToCompare && dataToCompare.length && dataToCompare.length >= 2 && screenWidth <= 599) {\r\n      alert(\"Không thể so sánh quá 2 sản phẩm!\");\r\n      return false;\r\n    }\r\n    if (isAddToLocal) {\r\n      dataToCompare.push(data);\r\n      localStorage.setItem(localStorageCompareKey, JSON.stringify(dataToCompare));\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const [statusShare, setStatusShare] = React.useState<boolean>(false);\r\n  const handleShare = (status: boolean) => {\r\n    setStatusShare(status);\r\n    handleTracking('share_click');\r\n  };\r\n\r\n  const handleFavorite = (status: boolean) => {\r\n    if (likeStatus) {\r\n      return false;\r\n    } else {\r\n      setLikeStatus(true);\r\n    }\r\n    handleTracking('like');\r\n    alert(\"Đã thêm vào danh sách Yêu thích\");\r\n    if (props.type === 'project') {\r\n      apolloClient.mutate({mutation: ADD_PROJECT_WISH_LIST, variables: {\r\n          \"input\": {\r\n            \"project_id\": props.dataObject.id,\r\n            \"status\": \"like\"\r\n          }\r\n        }}).then((response: any) => {\r\n      });\r\n    } else {\r\n      apolloClient.mutate({mutation: ADD_AD_SELL_LEASE_WISH_LIST, variables: {\r\n          \"input\" : {\r\n            \"ad_sell_lease_id\": props.dataObject.id,\r\n            \"status\": \"like\"\r\n          }\r\n        }}).then((response: any) => {\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleReport = () => {\r\n    handleTracking('report');\r\n    alert (\"Đã báo cáo thành công!\");\r\n  };\r\n\r\n  const dataBreadcrumbs = [];\r\n\r\n  let dataType1Breadcrumbs = {\r\n    href: '',\r\n    href_as: '',\r\n    name: ''\r\n  };\r\n\r\n  let dataType2Breadcrumbs = {\r\n    href: '',\r\n    href_as: '',\r\n    name: ''\r\n  };\r\n\r\n  for (let index in adSellLeaseCategory) {\r\n    if (props.dataObject.type && props.dataObject.type.type1 === adSellLeaseCategory[index].id) {\r\n      dataType1Breadcrumbs = {\r\n        href: '/slug',\r\n        href_as: adSellLeaseCategory[index].slug,\r\n        name: adSellLeaseCategory[index].name\r\n      }\r\n    }\r\n  }\r\n\r\n  for (let index in adSellLeaseType) {\r\n    if (props.dataObject.type && ((adSellLeaseType[index].id).indexOf(props.dataObject.type.type2) !== -1)) {\r\n      dataType2Breadcrumbs = {\r\n        href: '/slug',\r\n        href_as: adSellLeaseType[index].slug,\r\n        name: adSellLeaseType[index].name\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!Validator.isBlank(dataType1Breadcrumbs.href_as)) {\r\n    dataBreadcrumbs.push(dataType1Breadcrumbs)\r\n  }\r\n  if (!Validator.isBlank(dataType2Breadcrumbs.href_as)) {\r\n    dataBreadcrumbs.push(dataType2Breadcrumbs)\r\n  }\r\n  return (\r\n    <div className=\"title-project\">\r\n      <Breadcrumbs dataBreadcrumbs={dataBreadcrumbs}/>\r\n      <h1 className=\"title-project__title\">{title}</h1>\r\n      {\r\n        props.dataObject &&  props.dataObject.address && props.dataObject.address.text &&\r\n        <div className=\"title-project__address\">\r\n          Địa chỉ: {props.dataObject.address.text}</div>\r\n      }\r\n      <div className=\"title-project__bottom\">\r\n\r\n        <div className=\"title-project__bottom__share\">\r\n          <div className={(likeStatus)?\"title-project__bottom__share__item active\":\"title-project__bottom__share__item\"}>\r\n            <Button onClick={() => handleFavorite(true)}>\r\n              <FavoriteIcon/> Yêu thích\r\n            </Button>\r\n          </div>\r\n          <div className=\"title-project__bottom__share__item\">\r\n            <Button onClick={() => handleShare(true)}>\r\n              <ReplyIcon/> Chia sẻ\r\n            </Button>\r\n          </div>\r\n          <div className=\"title-project__bottom__share__item\">\r\n            <Button onClick={() => clickAddToCompare()}>\r\n              <PlaylistAddIcon/> So sánh\r\n            </Button>\r\n          </div>\r\n          <div className=\"title-project__bottom__share__item\">\r\n            <Button onClick={() => handleReport()}>\r\n              <ReportIcon/> Báo cáo\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"title-project__bottom__publish\">{(props.dataObject && props.dataObject.view_count)?props.dataObject.view_count + ' lượt xem - ':''}\r\n          {\r\n            props.dataObject &&\r\n            <>\r\n              Ngày đăng <Moment unix format=\"DD/MM/YYYY\">\r\n              {Number(props.dataObject.created_at)/1000}\r\n            </Moment>\r\n            </>\r\n          }\r\n        </div>\r\n      <SharePopup onClose={() => setStatusShare(false)} statusModal={statusShare} objectUrl={props.objectUrl}/>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TitleBlock;\r\n"]},"metadata":{},"sourceType":"module"}